# Cakes and Order

![Cakes & Order](https://github.com/Into-Y0u/My-Life-in-Cognizant/blob/fa84948357164775484cd6049909d24498460e30/SQL%20Handson/CakeOrderingSystem%20(1).png)

### 1. Customer Details Based on Gmail Account : 
   Write a query to display the customer details who have a gmail account. Sort the result set based on the customer name in descending order.
   ```sh
   SELECT cust_id,cust_name,address,phone_no ,email_id FROM Customers WHERE Email_id LIKE '%@gmail.com' ORDER BY cust_name DESC;
   ```
### 2. Cake name with first letter 'C' : 
   Write a query to display the Cake name that starts with the letter 'C' and is priced more than 800 dollar. Sort the result set in descending order based on price.
   ```sh
   SELECT Cake_name FROM Cakes WHERE Cake_name LIKE 'C%' AND Price_Per_Kg > 800 ORDER BY Price_Per_Kg DESC ;
   ```
 
### 3. Order details based on date : 
  Write a query to display the order id, customer id, order date, delivery date of the orders where the order date and delivery date is not the same date. Sort the result based on the customer id in descending order..
  ```sh
  SELECT Order_id, Cust_id, Order_date, Delivery_date FROM Orders WHERE Order_date <> Delivery_date ORDER BY Cust_id DESC;
  ```
### 4. Customer Contact_Info : 
   Write a query to display the Customer id, customer name and phone number of the customer. If the phone number is not available, then display the email id. Give an alias as Contact_Info.  Sort the result set based on the customer name in ascending order.
   ```sh
   SELECT Cust_id, Cust_name,
  (
    CASE
      WHEN Phone_no IS NULL THEN Email_id
      ELSE Phone_no 
    END
  )AS Contact_Info
   FROM
      Customers
   ORDER BY
      Cust_name;
   ```
### 5. Cake Password Generation : 
  Write a query to display the cake name and password. Password should be generated by concatenating the first three characters of cake name and the first three characters of cake id and give an alias name as Password. Sort the result based on descending order of Password.
  ```sh
  SELECT Cake_name , CONCAT( SUBSTRING(Cake_name, 1, 3) , SUBSTRING(Cake_id, 1, 3) ) AS Password
   FROM
      Cakes 
   ORDER BY
      Password DESC;
  ```
  
### 6. Order details based on month : 
  Write a query to display the order id and customer id of all the orders placed in the month of 'APRIL'. Sort the result set based on customer id in ascending order and order id in descending order.
  ```sh
select Order_id , Cust_id FROM Orders where (Month (Order_date )) = 4 Order BY Cust_id asc 
, Order_id desc;;
  ```
### 7. Display Minimum price : 
  Write a query to display the Cake flavour and minimum price of the cake. Give an alias name as 'MIN_PRICE'. Sort the result set based on descending order of the cake flavour.
  ```sh
SELECT DISTINCT Cake_flavour ,  MIN(Price_Per_Kg)  FROM Cakes GROUP BY Cake_flavour order by  Cake_flavour DESC ;
  ```
 
### 8. Total Price and Average Price : 
  Write a query to display the Cake Type, Total price and average price of the cakes. Give an alias name as 'TOTAL_PRICE' and 'AVG_PRICE' respectively. Sort the result set based on ascending order of the Total_Price..
  ```sh
select Cake_type , SUM(Price_Per_kg) AS  Total_Price , avg(Price_Per_kg) AS  AVG_Price from Cakes group BY Cake_type 
order by  Total_Price; 
  ```
### 9. Display Order and cake details : 
  Write a query to display the cake id, cake name, price, quantity and order id of all the cakes available in the cake table. Sort the result based on order id in ascending order and cake id in descending order...
  ```sh
select c.cake_id , c.cake_name , c.price_per_kg , o.quantity , o.order_id  from 
Cakes c left join order_details o on c.cake_id = o.cake_id order by o.order_id asc,c.cake_id desc;  
  ```
### 10. Order Details with total amount : 
  Write a query to display the order id, customer name, cake name, order date, delivery date, price_per_kg, quantity and total amount paid by the customer. Calculate the total amount using price_per_kg and quantity. Give an alias name as 'TOT_AMT'. Sort the result based on descending order of customer name and ascending order of cake_name.
  ```sh
select d.order_id ,cu.cust_name , c.cake_name , o.order_date , o.delivery_date , c.price_per_kg , d.quantity ,
c.price_per_kg * d.quantity AS TOT_AMT from Customers cu natural join Orders o  natural join Order_details d natural join Cakes c
order by cu.cust_name desc , c.cake_name asc ; 
  ```
### 11. Display cake name that is not ordered : 
  Write a query to display the cake name which is not ordered by any customer. Sort the result set based on ascending order of cake name.
  ```sh
select c.cake_name  from cakes c left join Order_details o  on c.cake_id = o.cake_id
where  o.order_id is null order by c.cake_name asc;
  ```
### 12. Display Maximum order : 
  Write a query to display the customer id and the maximum number of orders placed by the customer. Give an alias name as 'MAX_COUNT'. 
  ```sh
select cust_id , count(cust_id) MAX_COUNT from Orders group by cust_id 
having count(cust_id) =  
(select max(a.alu) from 
(select count(cust_id) as alu from Orders  group by cust_id) as a) ;
  ```
### 13. Cake Order Detailsr : 
  Write a query to display the cake name,cake flavour and price of all the cake which was ordered less than 5 times. Sort the result based on the ascending order of price. 
  ```sh
select c.cake_name ,c.cake_flavour , c.price_per_kg    from cakes c natural join order_details o 
 group by o.cake_id 
having count( o.order_id ) < 5 order by c.price_per_kg ;
  ```
